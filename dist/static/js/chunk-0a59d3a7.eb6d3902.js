(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a59d3a7"],{"1bdf":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",[a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.addApartLoading,expression:"addApartLoading"}],attrs:{"close-on-press-escape":!1,"element-loading-text":"添加中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",title:"添加部门",visible:t.dialogTableVisible,center:"","append-to-body":!0,"lock-scroll":!1,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("section",[a("el-container",[a("el-form",{attrs:{"label-width":"120px"},model:{value:t.newApart,callback:function(e){t.newApart=e},expression:"newApart"}},[a("el-row",[a("el-col",[a("el-form-item",{attrs:{label:"名字",prop:"name"}},[a("el-input",{attrs:{clearable:""},model:{value:t.newApart.name,callback:function(e){t.$set(t.newApart,"name",e)},expression:"newApart.name"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",[a("el-form-item",{attrs:{label:"描述",prop:"des"}},[a("el-input",{attrs:{clearable:""},model:{value:t.newApart.des,callback:function(e){t.$set(t.newApart,"des",e)},expression:"newApart.des"}})],1)],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogTableVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addApartConfirmBtnAction()}}},[t._v("添 加")])],1)],1)]),t._v(" "),a("el-main",[a("el-tree",{attrs:{data:t.apartDisplayData,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,props:t.defaultProps},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.node,r=e.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[t._v(t._s(n.label))]),t._v(" "),a("span",[a("el-button",{attrs:{type:"text",size:"mini",title:"添加"},on:{click:function(){return t.addSubApart(n,r)}}},[a("i",{staticClass:"el-icon-plus ann"})]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",title:"删除"},on:{click:function(){return t.removeApart(n,r)}}},[a("i",{staticClass:"el-icon-minus ann"})])],1)])}}])})],1)],1)},r=[],i=(a("673e"),a("7f7f"),{data:function(){return{apartDisplayData:[],apartList:[],defaultProps:{children:"sub",label:"apart_name"},addApartLoading:!1,dialogTableVisible:!1,newApart:{name:null,des:null},parentApartItem:null}},created:function(){this.loadApartments()},methods:{loadApartments:function(){var t=this;this.http.post("/apart/all").then((function(e){var a=e.data;t.apartList=a;var n=a.length;if(0==n)return[];for(var r={},i=0;i<n;i++){var s=a[i],o=r[s.parent_id];null==o?r[s.parent_id]=[s]:o.push(s)}for(var l=r[0],c=l.length,p=0;p<c;p++){var u=l[p];u["sub"]=t.subApartsFor(u,r)}t.apartDisplayData=l})).catch((function(t){}))},subApartsFor:function(t,e){var a=e[t.id];if(null==a||0==a.length)return[];for(var n=a.length,r=0;r<n;r++){var i=a[r];i["sub"]=this.subApartsFor(i,e)}return a},addSubApart:function(t,e){null!=e&&(this.parentApartItem=e,this.dialogTableVisible=!0)},addApartConfirmBtnAction:function(){var t={name:this.newApart.name,des:this.newApart.des,parent_id:this.parentApartItem.id};this.addApartLoading=!0;var e=this;this.http.post("/apart/add",t).then((function(t){e.dialogTableVisible=!1,e.addApartLoading=!1,e.loadApartments(),e.$message({type:"success",message:"添加部门成功"})})).catch((function(t){e.addApartLoading=!1,e.dialogTableVisible=!1,e.$message({type:"error",message:"添加部门失败"})}))},removeApart:function(t,e){var a=this;this.$confirm("此操作将删除该组部门及其子部门, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){console.log(e);var t=[];a.subApartListForItem(e,t),console.log(t);var n={list:t};a.http.post("/apart/delete",n).then((function(t){a.$message({type:"success",message:"删除成功!"}),a.loadApartments()})).catch((function(t){a.$message({type:"info",message:"删除失败!"}),console.log(t)}))})).catch((function(){a.$message({type:"info",message:"已取消删除"})}))},subApartListForItem:function(t,e){var a=t.sub.length;if(e.push({id:t.id}),0!=a)for(var n=0;n<a;n++){var r=t.sub[n];this.subApartListForItem(r,e)}}}}),s=i,o=(a("ff21"),a("2877")),l=Object(o["a"])(s,n,r,!1,null,null,null);e["default"]=l.exports},"386b":function(t,e,a){var n=a("5ca1"),r=a("79e5"),i=a("be13"),s=/"/g,o=function(t,e,a,n){var r=String(i(t)),o="<"+e;return""!==a&&(o+=" "+a+'="'+String(n).replace(s,"&quot;")+'"'),o+">"+r+"</"+e+">"};t.exports=function(t,e){var a={};a[t]=e(o),n(n.P+n.F*r((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",a)}},"673e":function(t,e,a){"use strict";a("386b")("sub",(function(t){return function(){return t(this,"sub","","")}}))},aff3:function(t,e,a){},ff21:function(t,e,a){"use strict";var n=a("aff3"),r=a.n(n);r.a}}]);