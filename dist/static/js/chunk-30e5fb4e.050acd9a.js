(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30e5fb4e"],{"687a":function(e,t,o){"use strict";var n=o("93fb"),a=o.n(n);a.a},"7a07":function(e,t,o){"use strict";var n=o("842b"),a=o.n(n);a.a},"842b":function(e,t,o){},"87dc":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[o("el-header",[e._v("\n        企业账号管理\n        "),o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.addBtnClick()}}},[e._v("+添加")]),e._v(" "),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:3}},[o("el-input",{attrs:{placeholder:"请输入内容"},on:{change:e.searchKeyWordChange},model:{value:e.inputKeyWord,callback:function(t){e.inputKeyWord=t},expression:"inputKeyWord"}})],1),e._v(" "),o("el-col",{attrs:{span:3}},[o("el-button",{on:{click:function(t){return e.searchBtnAction()}}},[e._v("搜索")])],1)],1),e._v(" "),o("companyaccountcreate",{ref:"createCompanyAccountView",attrs:{isCreate:e.isCreate},on:{addBtnClick:e.createCompleteWithModel,modifyBtnClick:e.modifyComplete,viewDidClosed:e.addViewDidClosed}})],1),e._v(" "),o("el-main",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"sort-change":e.tableSortChange}},[o("el-table-column",{attrs:{prop:"id",label:"ID"}}),e._v(" "),o("el-table-column",{attrs:{prop:"company_name",sortable:"custom",label:"企业主体名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"company_account_id",sortable:"custom",label:"企业账户ID"}}),e._v(" "),o("el-table-column",{attrs:{prop:"domain",sortable:"custom",label:"域名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"isunlock",label:"是否解限"}}),e._v(" "),o("el-table-column",{attrs:{label:"账户状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(e.accountStatus[t.row.status].label))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"user_id",label:"用户"}}),e._v(" "),o("el-table-column",{attrs:{prop:"companyaccount_remark",label:"备注"}}),e._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){return e.handleTableClick(t.row)}}},[e._v("修改")]),e._v(" "),o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){return e.handleTableDeleteClick(t.row)}}},[e._v("移除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{background:"","page-size":10,"current-page":e.currentPage,layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.changeCurrentPage}})],1)],1)},a=[],i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-container",{attrs:{height:"0"}},[o("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.addCompanyAccountLoading,expression:"addCompanyAccountLoading"}],attrs:{"close-on-press-escape":!1,"element-loading-text":e.loadingText,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",title:e.title,visible:e.viewVisible,center:"","append-to-body":!0,"lock-scroll":!1,width:"60%","close-on-click-modal":!1,closed:e.viewDidClosed},on:{"update:visible":function(t){e.viewVisible=t}}},[o("section",[o("el-container",[o("el-form",{attrs:{"label-width":"130px",inline:!0},model:{value:e.modifyModel,callback:function(t){e.modifyModel=t},expression:"modifyModel"}},[o("el-form-item",{attrs:{label:"企业账户ID"}},[o("el-input",{model:{value:e.modifyModel.company_account_id,callback:function(t){e.$set(e.modifyModel,"company_account_id",t)},expression:"modifyModel.company_account_id"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"店铺ID"}},[o("el-autocomplete",{attrs:{"fetch-suggestions":e.queryShopSearchAsync,placeholder:"请输入域名搜索"},on:{select:e.handleSelectShop},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item;return[o("div",{staticClass:"name"},[e._v(e._s(n.domain))]),e._v(" "),o("span",{staticClass:"addr"},[e._v(e._s(n.id))])]}}]),model:{value:e.shop_id,callback:function(t){e.shop_id=t},expression:"shop_id"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"企业主体ID"}},[o("el-autocomplete",{attrs:{"fetch-suggestions":e.queryCompanySearchAsync,placeholder:"请企业名搜索"},on:{select:e.handleSelectCompany},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item;return[o("div",{staticClass:"name"},[e._v(e._s(n.company_name))]),e._v(" "),o("span",{staticClass:"addr"},[e._v(e._s(n.id))])]}}]),model:{value:e.company_id,callback:function(t){e.company_id=t},expression:"company_id"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"是否解限"}},[o("el-input",{model:{value:e.modifyModel.isunlock,callback:function(t){e.$set(e.modifyModel,"isunlock",t)},expression:"modifyModel.isunlock"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"账户状态"}},[o("el-select",{staticStyle:{width:"185px"},attrs:{placeholder:"请选择"},model:{value:e.modifyModel.status,callback:function(t){e.$set(e.modifyModel,"status",t)},expression:"modifyModel.status"}},e._l(e.statusOptions,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),o("el-form-item",{attrs:{label:"用户"}},[o("el-autocomplete",{attrs:{"fetch-suggestions":e.queryUserSearchAsync,placeholder:"请输入用户名搜索"},on:{select:e.handleSelectUser},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item;return[o("div",{staticClass:"name"},[e._v(e._s(n.user_name))]),e._v(" "),o("span",{staticClass:"addr"},[e._v(e._s(n.id))])]}}]),model:{value:e.user_id,callback:function(t){e.user_id=t},expression:"user_id"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{model:{value:e.modifyModel.companyaccount_remark,callback:function(t){e.$set(e.modifyModel,"companyaccount_remark",t)},expression:"modifyModel.companyaccount_remark"}})],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.viewVisible=!1}}},[e._v("取 消")]),e._v(" "),e.isCreate?o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addCompanyConfirmBtnAction()}}},[e._v("添 加")]):o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.modifyCompanyConfirmBtnAction()}}},[e._v("修 改")])],1)],1)])],1)},c=[],l=(o("6b54"),{data:function(){return{addCompanyAccountLoading:!1,title:"",loadingText:"",viewVisible:!1,statusOptions:[{value:0,label:"正常"},{value:1,label:"封户"},{value:2,label:"申诉中"}],shop_id:"",company_id:"",user_id:"",modifyModel:{}}},props:{originModel:null,isCreate:!0},created:function(){},methods:{viewDidClosed:function(){this.$emit("viewDidClosed")},close:function(){this.closeLoading(),this.viewVisible=!1},show:function(e,t){this.modifyModel=t,console.log(t),null!=this.modifyModel.user_id?this.user_id=this.modifyModel.user_id.toString():this.user_id="",null!=this.modifyModel.company_id?this.company_id=this.modifyModel.company_id.toString():this.company_id="",null!=this.modifyModel.shop_id?this.shop_id=this.modifyModel.shop_id.toString():this.shop_id="",this.title=e,this.viewVisible=!0},loading:function(e){this.loadingText=e,this.addCompanyAccountLoading=!0},closeLoading:function(){this.loadingText="",this.addCompanyAccountLoading=!1},queryShopSearchAsync:function(e,t){if(null!=e&&0!=e.length){var o={search:e};this.http.post("/shop/search",o).then((function(e){t(e.data)})).catch((function(e){t([])}))}else t([])},handleSelectShop:function(e){this.shop_id=e.id.toString(),this.modifyModel.shop_id=e.id},queryCompanySearchAsync:function(e,t){if(null!=e&&0!=e.length){var o={search:e};this.http.post("/company/search",o).then((function(e){t(e.data)})).catch((function(e){t([])}))}else t([])},handleSelectCompany:function(e){this.company_id=e.id.toString(),this.modifyModel.company_id=e.id},queryUserSearchAsync:function(e,t){if(null!=e&&0!=e.length){var o={search:e};this.http.post("/user/search",o).then((function(e){t(e.data)})).catch((function(e){t([])}))}else t([])},handleSelectUser:function(e){this.user_id=e.id.toString(),this.modifyModel.user_id=e.id},addCompanyConfirmBtnAction:function(){null!=this.modifyModel.company_account_id&&0!=this.modifyModel.company_account_id.length?this.$emit("addBtnClick",this.modifyModel):this.$message({type:"error",message:"企业账户ID不能为空"})},modifyCompanyConfirmBtnAction:function(){this.$emit("modifyBtnClick",this.modifyModel)}}}),s=l,r=(o("7a07"),o("2877")),d=Object(r["a"])(s,i,c,!1,null,"1628e931",null),u=d.exports,m={name:"CompanyAccountManage",data:function(){return{loading:!1,isCreate:!0,tableData:[],originModel:null,accountStatus:[{value:0,label:"正常"},{value:1,label:"封户"},{value:2,label:"申诉中"}],inputKeyWord:"",currentPage:1,totalCount:0,order:null}},components:{companyaccountcreate:u},created:function(){this.loadCompanyAccount()},methods:{loadCompanyAccount:function(e,t,o){null==e&&(e=1);var n=this,a={page:e,order:t,search:o};this.http.post("/account/company/all",a).then((function(o){n.order=t,n.currentPage=e,n.totalCount=10*o.data.total_page,n.tableData=o.data.res})).catch((function(e){n.$message({type:"errir",message:"加载企业账号失败"})}))},addViewDidClosed:function(){this.originModel=null},addBtnClick:function(){this.isCreate=!0;var e={};this.$refs.createCompanyAccountView.show("添加企业账号",e)},handleTableClick:function(e){this.originModel=e;var t={id:e.id,company_account_id:e.company_account_id,shop_id:e.shop_id,company_id:e.company_id,isunlock:e.isunlock,status:e.status,companyaccount_remark:e.companyaccount_remark,user_id:e.user_id};this.isCreate=!1,this.$refs.createCompanyAccountView.show("修改企业账号",t)},handleTableDeleteClick:function(e){var t=this;this.$confirm("此操作将删除该企业账号, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var o={id:e.id};t.loading=!0;var n=t;t.http.post("/account/company/delete",o).then((function(e){n.loading=!1,n.loadCompanyAccount(),n.$message({type:"success",message:"删除企业账号成功"})})).catch((function(e){n.loading=!1,n.$message({type:"error",message:"删除企业账号失败"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},createCompleteWithModel:function(e){console.log("createCompleteWithModel"),console.log(e);var t={company_account_id:e.company_account_id,shop_id:e.shop_id,company_id:e.company_id,isunlock:e.isunlock,status:e.status,companyaccount_remark:e.companyaccount_remark,user_id:e.user_id},o=this;this.$refs.createCompanyAccountView.loading("添加企业账号"),this.http.post("/account/company/add",t).then((function(e){o.$refs.createCompanyAccountView.close(),o.$message({type:"success",message:"添加企业账号成功"}),o.loadCompanyAccount()})).catch((function(e){o.$refs.createCompanyAccountView.closeLoading(),o.$message({type:"error",message:"添加企业账号失败"})}))},modifyComplete:function(e){if(this.originModel.company_account_id!=e.company_account_id||this.originModel.shop_id!=e.shop_id||this.originModel.company_id!=e.company_id||this.originModel.isunlock!=e.isunlock||this.originModel.status!=e.status||this.originModel.user_id!=e.user_id||this.originModel.companyaccount_remark!=e.companyaccount_remark){var t={id:e.id,company_account_id:e.company_account_id,shop_id:e.shop_id,company_id:e.company_id,isunlock:e.isunlock,status:e.status,companyaccount_remark:e.companyaccount_remark,user_id:e.user_id},o=this;this.$refs.createCompanyAccountView.loading("修改企业账号"),this.http.post("/account/company/modify",t).then((function(e){o.$refs.createCompanyAccountView.close(),o.$message({type:"success",message:"修改企业账号成功"}),o.loadCompanyAccount()})).catch((function(e){o.$refs.createCompanyAccountView.closeLoading(),o.$message({type:"error",message:"修改企业账号失败"})}))}},searchKeyWordChange:function(){this.searchBtnAction()},searchBtnAction:function(){this.inputKeyWord.length>0?this.loadCompanyAccount(1,this.order,this.inputKeyWord):this.loadCompanyAccount(1)},tableSortChange:function(e){e.column;var t=e.prop,o=e.order,n=0;if("descending"==o);else{if("ascending"!=o)return void this.loadCompanyAccount(this.currentPage,null);n=1}var a={prop:t,type:n};this.loadCompanyAccount(this.currentPage,a)},changeCurrentPage:function(e){this.inputKeyWord.length>0?this.loadCompanyAccount(e,this.currentOrder,this.inputKeyWord):this.loadCompanyAccount(e,this.currentOrder)}}},p=m,h=(o("687a"),Object(r["a"])(p,n,a,!1,null,"629329d4",null));t["default"]=h.exports},"93fb":function(e,t,o){}}]);